# TaqMDA
**Multi-dimensional analyse for RT QPCR data obtained from Taqman QPCR arrays **

## Motivation
TaqMDA is an R script developed to analyze large scale data obtained by RT-QPCR arrays. It generates a principal component analyze for the first 3 dimensions and a heatmap for each predefined groups.
Developed for the study: *...*

## Principle
TaqMDA.R is a simple R script which analyzes QPCR values from a CSV file (see example in /data).
For each qPCR target, if more than N % (defined by the user) of the values are undetermined, this will trigger its exclusion from the analysis. A list of genes containing NA, eliminated and retained is written in a txt file.
The remaining qPCR data are reduced, centered and classified by hierarchical cluster analysis. A principal component analyze is performed with FactoMineR package and summarized by graphs and tables in both individual and variable spaces. Finally, a distance matrix is generated by the Pearson method and subsequently used to create a heatmap scaled by individual sample thanks to gplots package.

## Get MirStat
**From the github repository**
 
```
git clone https://github.com/a-slide/TaqMDA
sudo chmod u+x TaqMDA.R
```
Alternatively, you can download the [zip archive](https://github.com/a-slide/TaqMDA/archive/master.zip) 

Add the executable to your system PATH

## Usage

* Format your **tab separated csv** data sheet as follow:

```  
            qPCR1   qPCR2   qPCR3   ...
sample1-1   0.23    0       12334   ...
sample1-2   12      0       8755    ...
sample1-3   65      0       87545   ...
...         ...     ...     ...     ...
```
See example file in the repository data folder

* Replace non detected qPCR values by NA (if not already done)

* Define a percentage of autorized NA values per gene to be considered as valid

Run the script with the data sheet and the percent of allowed NA values 
```
    USAGE: TaqMDA.R  <Sample_sheet.csv>  <max_percent_of_na_authorized>
        * Filename of csv file containing the data
        * Max percentage of values with NA allows per column

    EXAMPLE : TaqMDA.R ./data/Sample.csv 50
```

All files will be generated in the current folder

## Dependencies:
The program was developed under Linux Mint 16 "petra" but is compatible with other LINUX debian based distributions.

#### Program
* R 3.2.2 +

#### Third party R packages
* FactoMineR
* RColorBrewer
* gplots

## Authors and Contact
Adrien Leger - 2015
* <adrien.leger@gmail.com>  <adrien.leger@inserm.fr>  <adrien.leger@univ-nantes.fr>
* [Github](https://github.com/a-slide)
* [Atlantic Gene Therapies - INSERM 1089](http://www.atlantic-gene-therapies.fr/)
